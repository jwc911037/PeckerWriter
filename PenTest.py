#!/user/bin env python 
#-*- coding:utf8 -*-
import sys
import serial
import serial.tools.list_ports
import time

port_list = list(serial.tools.list_ports.comports())

if len(port_list) < 0:
    print 'No Serial Port Available Now!'
else:
    for port in port_list:
        port_serial = port[0]
        print "Available Port >> ",port_serial
   
    SERV_MOTOR_PORT = raw_input('Select a Serv Port: ')
     
    SERV_MOTOR_BAUDRATE = 9600
    serv = serial.Serial()
    serv.port = SERV_MOTOR_PORT
    serv.baudrate = SERV_MOTOR_BAUDRATE
    serv.timeout = 5
    
    try:
        serv.open()
    except serial.SerialException:
        print 'Counld Not Open Port: '+serv.port
    
    if serv.isOpen():
        serv.flushInput()
        last_status = '0'
        while True:
            try:
                pen_status = raw_input('Input 1 or 2 to wake the pen: ')
            except Exception:
                serv.close()
                print serv.port+' Is Closed. Have A Nice Day!'
                break
            
            if pen_status != '1' and pen_status != '2':
                serv.close()
                print serv.port+' Is Closed. Have A Nice Day!'
                break
            if pen_status != last_status:
                print pen_status,' ',last_status
                serv.write(pen_status+'\n')
                # time.sleep(0.2)
            print pen_status+' done!'
            last_status = pen_status
    else:
        print 'Sorry, '+serv.port+' Is Down!'